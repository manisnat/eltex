root@eltex-practice2-pg1-v27:~# journalctl -q -b 0 -o short-full --until "$(date -d "$(journalctl -q -b 0 -o short-full | head -1 | awk '{print $2" "$3}') + 1.5 seconds" +"%F %H:%M:%S.%N")"
Fri 2025-07-11 02:21:12 UTC localhost kernel: Linux version 6.8.0-55-generic (buildd@lcy02-amd64-095) (x86_64-linux-gnu-gcc-13 (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0, GNU ld (GNU Binutils for Ubuntu) 2.42) #57-Ubuntu SMP PREEMPT_DYNAMIC Wed Feb 12 23:42:21 UTC 2025 (Ubuntu 6.8.0-55.57-generic 6.8.12)

Fri 2025-07-11 02:21:12 UTC localhost kernel: Command line: BOOT_IMAGE=/vmlinuz-6.8.0-55-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro
Fri 2025-07-11 02:21:12 UTC localhost kernel: KERNEL supported cpus:
Fri 2025-07-11 02:21:12 UTC localhost kernel:   Intel GenuineIntel
Fri 2025-07-11 02:21:12 UTC localhost kernel:   AMD AuthenticAMD
Fri 2025-07-11 02:21:12 UTC localhost kernel:   Hygon HygonGenuine
Fri 2025-07-11 02:21:12 UTC localhost kernel:   Centaur CentaurHauls
Fri 2025-07-11 02:21:12 UTC localhost kernel:   zhaoxin   Shanghai  
Fri 2025-07-11 02:21:12 UTC localhost kernel: BIOS-provided physical RAM map:
Fri 2025-07-11 02:21:12 UTC localhost kernel: BIOS-e820: [mem 0x0000000000000000-0x000000000009fbff] usable
Fri 2025-07-11 02:21:12 UTC localhost kernel: BIOS-e820: [mem 0x000000000009fc00-0x000000000009ffff] reserved
Fri 2025-07-11 02:21:12 UTC localhost kernel: BIOS-e820: [mem 0x00000000000f0000-0x00000000000fffff] reserved
Fri 2025-07-11 02:21:12 UTC localhost kernel: BIOS-e820: [mem 0x0000000000100000-0x00000000bffd9fff] usable
Fri 2025-07-11 02:21:12 UTC localhost kernel: BIOS-e820: [mem 0x00000000bffda000-0x00000000bfffffff] reserved
Fri 2025-07-11 02:21:12 UTC localhost kernel: BIOS-e820: [mem 0x00000000feffc000-0x00000000feffffff] reserved
Fri 2025-07-11 02:21:12 UTC localhost kernel: BIOS-e820: [mem 0x00000000fffc0000-0x00000000ffffffff] reserved
Fri 2025-07-11 02:21:12 UTC localhost kernel: BIOS-e820: [mem 0x0000000100000000-0x000000013fffffff] usable
Fri 2025-07-11 02:21:12 UTC localhost kernel: BIOS-e820: [mem 0x000000fd00000000-0x000000ffffffffff] reserved
Fri 2025-07-11 02:21:12 UTC localhost kernel: NX (Execute Disable) protection: active
Fri 2025-07-11 02:21:12 UTC localhost kernel: APIC: Static calls initialized
Fri 2025-07-11 02:21:12 UTC localhost kernel: SMBIOS 2.8 present.
Fri 2025-07-11 02:21:12 UTC localhost kernel: DMI: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.3-0-ga6ed6b701f0a-prebuilt.qemu.org 04/01/2014
Fri 2025-07-11 02:21:12 UTC localhost kernel: Hypervisor detected: KVM
Fri 2025-07-11 02:21:12 UTC localhost kernel: kvm-clock: Using msrs 4b564d01 and 4b564d00
Fri 2025-07-11 02:21:12 UTC localhost kernel: kvm-clock: using sched offset of 7936395945521 cycles
Fri 2025-07-11 02:21:12 UTC localhost kernel: clocksource: kvm-clock: mask: 0xffffffffffffffff max_cycles: 0x1cd42e4dffb, max_idle_ns: 881590591483 ns
Fri 2025-07-11 02:21:12 UTC localhost kernel: tsc: Detected 3399.998 MHz processor
...
Fri 2025-07-11 02:21:13 UTC localhost systemd-modules-load[320]: Inserted module 'msr'
Fri 2025-07-11 02:21:13 UTC localhost systemd-modules-load[320]: Inserted module 'dm_multipath'
Fri 2025-07-11 02:21:13 UTC localhost systemd[1]: Finished systemd-modules-load.service - Load Kernel Modules.
Fri 2025-07-11 02:21:13 UTC localhost systemd[1]: Starting systemd-sysctl.service - Apply Kernel Variables...
Fri 2025-07-11 02:21:13 UTC localhost systemd[1]: Finished systemd-sysctl.service - Apply Kernel Variables.
Fri 2025-07-11 02:21:13 UTC localhost systemd[1]: modprobe@efi_pstore.service: Deactivated successfully.
Fri 2025-07-11 02:21:13 UTC localhost systemd[1]: Finished modprobe@efi_pstore.service - Load Kernel Module efi_pstore.
Fri 2025-07-11 02:21:13 UTC localhost kernel: EXT4-fs (dm-0): re-mounted 78dfc1ab-05ce-40b9-a2f8-2f3e03168145 r/w. Quota mode: none.
Fri 2025-07-11 02:21:13 UTC localhost systemd[1]: Finished systemd-remount-fs.service - Remount Root and Kernel File Systems.
Fri 2025-07-11 02:21:13 UTC localhost systemd[1]: Activating swap swap.img.swap - /swap.img...
Fri 2025-07-11 02:21:13 UTC localhost systemd[1]: Starting multipathd.service - Device-Mapper Multipath Device Controller...
Fri 2025-07-11 02:21:13 UTC localhost systemd[1]: systemd-hwdb-update.service - Rebuild Hardware Database was skipped because of an unmet condition check (ConditionNeedsUpdate=/etc).
Fri 2025-07-11 02:21:13 UTC localhost systemd[1]: Starting systemd-journal-flush.service - Flush Journal to Persistent Storage...
Fri 2025-07-11 02:21:13 UTC localhost systemd[1]: systemd-pstore.service - Platform Persistent Storage Archival was skipped because of an unmet condition check (ConditionDirectoryNotEmpty=/sys/fs/pstore).
Fri 2025-07-11 02:21:13 UTC localhost kernel: Adding 3261436k swap on /swap.img.  Priority:-2 extents:7 across:5735424k 
Fri 2025-07-11 02:21:13 UTC localhost systemd[1]: Starting systemd-random-seed.service - Load/Save OS Random Seed...
Fri 2025-07-11 02:21:13 UTC localhost systemd[1]: systemd-tpm2-setup.service - TPM2 SRK Setup was skipped because of an unmet condition check (ConditionSecurity=measured-uki).
Fri 2025-07-11 02:21:13 UTC localhost systemd[1]: Activated swap swap.img.swap - /swap.img.
Fri 2025-07-11 02:21:13 UTC localhost systemd[1]: Reached target swap.target - Swaps.


root@eltex-practice2-pg1-v27:~# find / -name auth.log
/var/log/auth.log
root@eltex-practice2-pg1-v27:~# awk '{print $3, substr($0, index($0,$4))}' /var/log/auth.log | sed 's/\[.*]://g' | sort
CRON pam_unix(cron:session): session opened for user root(uid=0) by root(uid=0)
CRON pam_unix(cron:session): session opened for user root(uid=0) by root(uid=0)
CRON pam_unix(cron:session): session opened for user root(uid=0) by root(uid=0)
CRON pam_unix(cron:session): session opened for user root(uid=0) by root(uid=0)
CRON pam_unix(cron:session): session opened for user root(uid=0) by root(uid=0)
CRON pam_unix(cron:session): session opened for user root(uid=0) by root(uid=0)
CRON pam_unix(cron:session): session opened for user root(uid=0) by root(uid=0)
CRON pam_unix(cron:session): session opened for user root(uid=0) by root(uid=0)
CRON pam_unix(cron:session): session opened for user root(uid=0) by root(uid=0)
CRON pam_unix(cron:session): session opened for user root(uid=0) by root(uid=0)
CRON pam_unix(cron:session): session opened for user root(uid=0) by root(uid=0)
CRON pam_unix(cron:session): session opened for user root(uid=0) by root(uid=0)
CRON pam_unix(cron:session): session opened for user root(uid=0) by root(uid=0)
CRON pam_unix(cron:session): session opened for user root(uid=0) by root(uid=0)
CRON pam_unix(cron:session): session opened for user root(uid=0) by root(uid=0)
sshd Accepted publickey for root from 172.16.8.4 port 41284 ssh2: RSA SHA256:yE3yakxVvz9KhQ6R5GDdO1bb3RZIqPsWuM3MmnJy0kQ
sshd Accepted publickey for root from 172.16.8.4 port 47028 ssh2: RSA SHA256:yE3yakxVvz9KhQ6R5GDdO1bb3RZIqPsWuM3MmnJy0kQ
sshd Accepted publickey for root from 172.16.8.4 port 55806 ssh2: RSA SHA256:yE3yakxVvz9KhQ6R5GDdO1bb3RZIqPsWuM3MmnJy0kQ
sshd Disconnected from user root 172.16.8.4 port 41284
sshd Disconnected from user root 172.16.8.4 port 55806
sshd pam_unix(sshd:session): session closed for user root
sshd pam_unix(sshd:session): session closed for user root
sshd pam_unix(sshd:session): session opened for user root(uid=0) by root(uid=0)
sshd pam_unix(sshd:session): session opened for user root(uid=0) by root(uid=0)
sshd pam_unix(sshd:session): session opened for user root(uid=0) by root(uid=0)
sshd Received disconnect from 172.16.8.4 port 41284:11: disconnected by user
sshd Received disconnect from 172.16.8.4 port 55806:11: disconnected by user
systemd-logind New session 578 of user root.
systemd-logind New session 587 of user root.
systemd-logind New session 726 of user root.
systemd-logind Removed session 578.
systemd-logind Removed session 587.
systemd-logind Session 578 logged out. Waiting for processes to exit.
systemd-logind Session 587 logged out. Waiting for processes to exit.

root@eltex-practice2-pg1-v27:~# awk '{print $3}' /var/log/auth.log | sed 's/\[.*//' | sort | uniq -c | sort -nr
    792 CRON
     14 sshd
      7 systemd-logind
      4 polkitd

root@eltex-practice2-pg1-v27:~# awk -F: '$7 == "/usr/sbin/nologin" {print $3 "," $1}' /etc/passwd | sort -k1 -nr | while IFS=, read uid username; do groups=$(id -nG "$username"); echo "$uid $username: $groups"; done
65534 nobody: nogroup
1002 user3: user3 users new_users_group
998 systemd-network: systemd-network
997 systemd-timesync: systemd-timesync
992 systemd-resolve: systemd-resolve
991 polkitd: polkitd
989 fwupd-refresh: fwupd-refresh
109 sshd: nogroup
108 usbmux: plugdev
107 landscape: landscape
105 tcpdump: tcpdump
104 uuidd: uuidd
103 syslog: syslog adm
101 messagebus: messagebus
42 _apt: nogroup
39 irc: irc
38 list: list
34 backup: backup
33 www-data: www-data
13 proxy: proxy
10 uucp: uucp
9 news: news
8 mail: mail
7 lp: lp
6 man: man
5 games: games
3 sys: sys
2 bin: bin
1 daemon: daemon

root@eltex-practice2-pg1-v27:~# dmesg | awk '/kernel/'
[    0.067548] Booting paravirtualized kernel on KVM
[    0.068976] Unknown kernel command line parameters "BOOT_IMAGE=/vmlinuz-6.8.0-55-generic", will be passed to user space.
[    0.136359] Memory: 3933488K/4193760K available (22528K kernel code, 4443K rwdata, 14344K rodata, 4988K init, 4716K bss, 260012K reserved, 0K cma-reserved)
[    0.623268] Loaded X.509 cert 'Build time autogenerated kernel key: e0bedf6fa049a1e09bd65ebab3904f14cdd5bc68'
[    0.726979] Loaded X.509 cert 'Build time autogenerated kernel key: e0bedf6fa049a1e09bd65ebab3904f14cdd5bc68'
[    0.750367] Freeing unused kernel image (initmem) memory: 4988K
[    0.751069] Write protecting the kernel read-only data: 38912k
[    0.752772] Freeing unused kernel image (rodata/data gap) memory: 2040K
[   28.707749] systemd[1]: Listening on systemd-udevd-kernel.socket - udev Kernel Socket.
[   28.717147] systemd[1]: Mounting sys-kernel-debug.mount - Kernel Debug File System...
[   28.721667] systemd[1]: Mounting sys-kernel-tracing.mount - Kernel Trace File System...

root@eltex-practice2-pg1-v27:~# awk 'END {print NR}' /var/log/kern.log
34

root@eltex-practice2-pg1-v27:~# awk '
    BEGIN { RS = ""; FS = "\n" }
    {
        cmd = ""; start = ""; end = ""
        for (i = 1; i <= NF; i++) {
            if ($i ~ /^Commandline:/) cmd = $i
            if ($i ~ /^Start-Date:/) start = $i
            if ($i ~ /^End-Date:/) end = $i
        }
        if (cmd && start && end) { 
            print cmd "; " start "; " end
        }
    }
' /var/log/apt/history.log 
...
Commandline: /usr/bin/unattended-upgrade; Start-Date: 2025-07-12  07:21:09; End-Date: 2025-07-12  07:21:29
Commandline: /usr/bin/unattended-upgrade; Start-Date: 2025-07-12  07:21:30; End-Date: 2025-07-12  07:21:44
Commandline: /usr/bin/unattended-upgrade; Start-Date: 2025-07-12  07:21:46; End-Date: 2025-07-12  07:21:57
Commandline: /usr/bin/unattended-upgrade; Start-Date: 2025-07-12  07:21:59; End-Date: 2025-07-12  07:22:06
Commandline: /usr/bin/unattended-upgrade; Start-Date: 2025-07-12  07:22:08; End-Date: 2025-07-12  07:22:25
Commandline: /usr/bin/unattended-upgrade; Start-Date: 2025-07-12  07:22:27; End-Date: 2025-07-12  07:22:30
Commandline: /usr/bin/unattended-upgrade; Start-Date: 2025-07-12  07:22:32; End-Date: 2025-07-12  07:22:36
Commandline: /usr/bin/unattended-upgrade; Start-Date: 2025-07-12  07:22:39; End-Date: 2025-07-12  07:22:46
Commandline: /usr/bin/unattended-upgrade; Start-Date: 2025-07-12  07:22:48; End-Date: 2025-07-12  07:23:30
Commandline: /usr/bin/unattended-upgrade; Start-Date: 2025-07-12  07:23:32; End-Date: 2025-07-12  07:23:42
Commandline: apt-get install bzip2; Start-Date: 2025-07-13  10:08:03; End-Date: 2025-07-13  10:08:06
Commandline: apt install 7zip; Start-Date: 2025-07-13  10:11:35; End-Date: 2025-07-13  10:11:38
Commandline: /usr/bin/unattended-upgrade; Start-Date: 2025-07-15  06:37:23; End-Date: 2025-07-15  06:37:33
Commandline: /usr/bin/unattended-upgrade; Start-Date: 2025-07-15  06:37:36; End-Date: 2025-07-15  06:37:58
Commandline: /usr/bin/unattended-upgrade; Start-Date: 2025-07-15  06:38:01; End-Date: 2025-07-15  06:38:03

